<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>LarrySong</title>
  <subtitle>write more, take on less</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://songlairui.github.io/"/>
  <updated>2017-06-22T07:55:05.000Z</updated>
  <id>http://songlairui.github.io/</id>
  
  <author>
    <name>Songlairui</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·äºŒï¼šå‰åç«¯æ··åˆä»ç²—æš´åˆ°æ­£å¸¸</title>
    <link href="http://songlairui.github.io/2017/06/22/vue-ssr-step-2/"/>
    <id>http://songlairui.github.io/2017/06/22/vue-ssr-step-2/</id>
    <published>2017-06-22T05:12:43.000Z</published>
    <updated>2017-06-22T07:55:05.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>å†™å®Œä¸Šä¸€ç¯‡<a href="/2017/06/21/vue-ssr-step-1/" title="Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·ä¸€ï¼šä»é›¶åˆ°ç²—æš´æ··åˆå‰åç«¯">Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·ä¸€ï¼šä»é›¶åˆ°ç²—æš´æ··åˆå‰åç«¯</a>ä¹‹åï¼Œæ€è·¯å˜æ¸…äº†ä¸å°‘ã€‚ä»Šå¤©ä¸­åˆå†è¯»å®Œ <a href="http://ssr.vuejs.org/en/build-config.html" target="_blank" rel="external">Build Configuration</a> ç« èŠ‚ï¼Œæ¯”è¾ƒè½»æ¾çš„è¿è¡Œäº†ç¤ºä¾‹ä»£ç ã€‚<br>ä¸è¿‡å¤šåŠ äº†å‡ ä¸ªwebpacké€‰é¡¹ï¼Œæ··åˆèµ·æ¥å˜å¾—æ›´åŠ ç®€å•ã€‚å¤§ç¥é“ºè·¯é“ºå¾—å°±æ˜¯å¥½ã€‚ã€‚  </p>
</blockquote>
<p><strong>å®è·µTarget:</strong> <a href="http://ssr.vuejs.org/en/build-config.html" target="_blank" rel="external">Build Configuration</a></p>
<h3 id="Serverç«¯-å¯ç”¨vue-ssr-plugin"><a href="#Serverç«¯-å¯ç”¨vue-ssr-plugin" class="headerlink" title="Serverç«¯ å¯ç”¨vue-ssr plugin"></a>Serverç«¯ å¯ç”¨vue-ssr plugin</h3><table>
<thead>
<tr>
<th>å¯ç”¨å‰</th>
<th>-</th>
<th>å¯ç”¨å</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b584a3e1e8.png" alt="server1.png"></td>
<td>-</td>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b5849e0aad.png" alt="server2.png"></td>
</tr>
<tr>
<td>å¯ç”¨å‰ï¼Œå¼‚æ­¥åŠ è½½çš„ç»„ä»¶ï¼Œè¢«åˆ†å‰²å¼€æ¥</td>
<td>-</td>
<td>å¯ç”¨åServerç«¯æ‰“åŒ…ä¸å†è¿›è¡Œåˆ†å‰²ï¼Œåªè¾“å‡ºä¸€ä¸ªæ–‡ä»¶</td>
</tr>
</tbody>
</table>
<p>å®¢æˆ·ç«¯æ‰“åŒ…ï¼Œå¯¹æ–‡ä»¶åˆ†å‰²å®ç°æ‡’åŠ è½½ï¼Œå¯ä»¥ä»¤æµè§ˆå™¨åªåŠ è½½éœ€è¦çš„å†…å®¹ï¼Œæœ‰ä½“éªŒæå‡ã€‚<br>ä½†æœåŠ¡ç«¯æ‰“åŒ…çš„æ–‡ä»¶ï¼Œç»™åç«¯ç¨‹åºä½¿ç”¨ï¼Œä¸é€šè¿‡ç½‘ç»œè¯·æ±‚è·å–ï¼Œåˆ†å‰²ä»£ç æ„ä¹‰ä¸å¤§ç”šè‡³é™ä½æ€§èƒ½ï¼Œæ‰€ä»¥æ‰“åŒ…æˆä¸€ä¸ªæ–‡ä»¶æ›´å¥½ã€‚</p>
<h3 id="Clientç«¯-å¯ç”¨-manifestï¼Œå¯ç”¨vue-ssr-plugin"><a href="#Clientç«¯-å¯ç”¨-manifestï¼Œå¯ç”¨vue-ssr-plugin" class="headerlink" title="Clientç«¯ å¯ç”¨ manifestï¼Œå¯ç”¨vue-ssr plugin"></a>Clientç«¯ å¯ç”¨ manifestï¼Œå¯ç”¨vue-ssr plugin</h3><p><strong>ç›¸å…³é…ç½®æ–‡ä»¶</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">    <span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</div><div class="line">      <span class="attr">name</span>: <span class="string">'mainfest'</span>,</div><div class="line">      <span class="attr">minChunks</span>: <span class="literal">Infinity</span></div><div class="line">    &#125;),</div><div class="line">    <span class="keyword">new</span> VueSSRClientPlugin()</div><div class="line">  ]</div></pre></td></tr></table></figure></p>
<p><strong>å¯¹æ¯”</strong> </p>
<table>
<thead>
<tr>
<th>å¯ç”¨å‰</th>
<th>-</th>
<th>å¯ç”¨å</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b5c09924cb.png" alt="client1.png"></td>
<td>-</td>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b5c0a7353b.png" alt="client2.png"></td>
</tr>
<tr>
<td>å¯ç”¨å‰ï¼Œå‰åç«¯è¾“å‡ºæ–‡ä»¶åç§°ä¸€è‡´ï¼Œä¼šé€ æˆè¦†ç›–</td>
<td>-</td>
<td>å¯ç”¨åï¼Œç”Ÿæˆ manifest, å¯ä»¥ä½¿ç”¨vue-ssræ’ä»¶è‡ªåŠ¨æ³¨å…¥js</td>
</tr>
</tbody>
</table>
<p>å¯ç”¨å‰ï¼Œåœ¨é¡µé¢æ³¨å…¥JSï¼Œéœ€è¦æ‰‹åŠ¨åœ¨ index.template.html ä½œå¦‚ä¸‹æ·»åŠ <br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!--vue-ssr-outlet--&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./dist/bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> <span class="comment">&lt;!-- æ‰‹åŠ¨æ·»åŠ ï¼Œå¯ç”¨åä¸éœ€è¦æ·»åŠ è¿™ä¸€è¡Œ--&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="ä¿®æ”¹server-js"><a href="#ä¿®æ”¹server-js" class="headerlink" title="ä¿®æ”¹server.js"></a>ä¿®æ”¹server.js</h2><p><strong>1. æ›´æ”¹renderer</strong>  </p>
<table>
<thead>
<tr>
<th>å‰</th>
<th>-</th>
<th>å</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b6c340b19b.png" alt="render1.png"></td>
<td>-</td>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b6c375263e.png" alt="render2.png"></td>
</tr>
<tr>
<td>createRender</td>
<td>-</td>
<td>æ›´æ”¹ä¸º createBundleRendererï¼Œå¹¶ç”±æ‰“åŒ…ç”Ÿæˆçš„å•æ–‡ä»¶åˆ›å»º</td>
</tr>
</tbody>
</table>
<p><strong>2. æ›´æ”¹expressé…ç½®</strong> </p>
<table>
<thead>
<tr>
<th>å‰</th>
<th>-</th>
<th>å</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b6e36a7ecf.png" alt="app1.png"></td>
<td>-</td>
<td><img src="https://ooo.0o0.ooo/2017/06/22/594b6e3622523.png" alt="app2.png"></td>
</tr>
<tr>
<td>ä»æ‰“åŒ…å¾—åˆ°çš„æ–‡ä»¶å¼•å…¥createApp</td>
<td>-</td>
<td>renderä¸­è‡ªåŠ¨åŒ…å«appå†…å®¹ï¼Œä¸éœ€è¦å¼•å…¥ã€‚åªéœ€è¦ä¼ å…¥context</td>
</tr>
</tbody>
</table>
<h2 id="æ›´æ”¹è·¯å¾„ï¼Œæ’¤é”€ç²—æš´"><a href="#æ›´æ”¹è·¯å¾„ï¼Œæ’¤é”€ç²—æš´" class="headerlink" title="æ›´æ”¹è·¯å¾„ï¼Œæ’¤é”€ç²—æš´"></a>æ›´æ”¹è·¯å¾„ï¼Œæ’¤é”€ç²—æš´</h2><p><strong>æ·»åŠ webpackå…³é”®é…ç½®</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">output:&#123;</div><div class="line">  <span class="attr">publicPath</span>: <span class="string">'/dist/'</span>,</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è‡ªåŠ¨æ³¨å…¥çš„script.src éƒ½æŒ‡å‘ dist ç›®å½•ä¸‹æ–‡ä»¶ï¼Œserver.jsä¸­å¼ºåˆ¶redirectçš„ä¸­é—´ä»¶é€»è¾‘å¯ä»¥åˆ é™¤äº†ã€‚</p>
<h2 id="ENDğŸ”š"><a href="#ENDğŸ”š" class="headerlink" title="ENDğŸ”š"></a>ENDğŸ”š</h2><p>å›é¡¾ä¸€ä¸‹ï¼Œå®ŒæˆæœåŠ¡ç«¯æ¸²æŸ“çš„é…ç½®ï¼Œå¤§éƒ¨åˆ†é webpackçš„ç†Ÿç»ƒåº¦ã€‚  </p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å†™å®Œä¸Šä¸€ç¯‡&lt;a href=&quot;/2017/06/21/vue-ssr-step-1/&quot; title=&quot;Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·ä¸€ï¼šä»é›¶åˆ°ç²—æš´æ··åˆå‰åç«¯&quot;&gt;Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·ä¸€ï¼šä»é›¶åˆ°ç²—æš´æ··åˆå‰åç«¯&lt;/a&gt;ä¹‹åï¼Œæ€è·¯å˜æ¸…äº†ä¸å°‘ã€‚ä»Šå¤©ä¸­
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·ä¸€ï¼šä»é›¶åˆ°ç²—æš´æ··åˆå‰åç«¯</title>
    <link href="http://songlairui.github.io/2017/06/21/vue-ssr-step-1/"/>
    <id>http://songlairui.github.io/2017/06/21/vue-ssr-step-1/</id>
    <published>2017-06-21T04:22:34.000Z</published>
    <updated>2017-06-22T07:52:51.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>Vue 2.3 å‘å¸ƒå¾ˆä¹…äº†ï¼Œè·ç¦»ç¬¬ä¸€æ¬¡æ‰“å¼€<a href="http://ssr.vuejs.org/en/" target="_blank" rel="external">ssr.vuejs</a>ä¹Ÿå¾ˆä¹…äº†ã€‚<br>ç°åœ¨æˆ‘ç»ˆäºæŠŠå…¶ä¸­çš„ä»£ç ç‰‡æ®µè¿è¡Œèµ·æ¥äº†ã€‚  </p>
</blockquote>
<p>Github Repo: <a href="https://github.com/songlairui/vue-playground" target="_blank" rel="external">https://github.com/songlairui/vue-playground</a></p>
<h2 id="1-å°è¯•-vue-server-renderer"><a href="#1-å°è¯•-vue-server-renderer" class="headerlink" title="1. å°è¯• vue-server-renderer"></a>1. å°è¯• <code>vue-server-renderer</code></h2><p>å®ç°ä½¿ç”¨ <code>console.log(html)</code> å°†æ¸²æŸ“è¿‡åçš„htmlæ‰“å°åˆ°å±å¹•ä¸Šã€‚<br>å³ï¼Œå°† new Vue({â€¦}) å˜æˆè¾“å‡ºç»“æœã€‚è·³è¿‡ä»æµè§ˆå™¨è·å¾—ç»“æœã€‚  </p>
<h2 id="2-ä½¿ç”¨-import-ã€-export-å…³é”®å­—"><a href="#2-ä½¿ç”¨-import-ã€-export-å…³é”®å­—" class="headerlink" title="2. ä½¿ç”¨ import ã€ export å…³é”®å­—"></a>2. ä½¿ç”¨ import ã€ export å…³é”®å­—</h2><p>æ–‡æ¡£ç¬¬å››ç« <a href="http://ssr.vuejs.org/en/structure.html" target="_blank" rel="external">Source Code Structure</a> å‡ºç°äº†ç›®å½•ç»“æ„ï¼Œè€Œä¸”jsæ–‡ä»¶ä¸­æœ‰äº†importå…³é”®å­—ã€‚<br>è¿™é‡Œæ— æ³•åƒå‰é¢çš„ä»£ç ç‰‡æ®µä¸€æ ·ï¼Œç›´æ¥åœ¨nodeé‡Œç²˜è´´ä»£ç å¯æ‰§è¡Œã€‚è¿™é‡Œéœ€è¦ä½¿ç”¨webpackã€‚  </p>
<blockquote>
<p>è¿™æ—¶çš„æˆ‘ï¼šä½¿ç”¨vue-cliåˆ›å»ºvueé¡¹ç›®è„šæ‰‹æ¶æ˜¯å”¯ä¸€çš„webpackä½¿ç”¨ç»éªŒã€‚<br>ç„¶åæˆ‘å» <a href="/2017/06/18/learn-webpack/" title="å­¦ä¹ webpack">å­¦ä¹ webpack</a></p>
</blockquote>
<p>ä»£ç ç¤ºä¾‹ï¼š <a href="https://github.com/songlairui/vue-playground/tree/master/demo/chapter4" target="_blank" rel="external">songlairui/vue-playground/demo/chapter4</a>  </p>
<p><strong>ç›®æ ‡:</strong> è®©è¿™æ ·çš„ç›®å½•èƒ½å¤Ÿæ‰§è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">src</div><div class="line">â”œâ”€â”€ components</div><div class="line">â”‚   â”œâ”€â”€ Foo.vue</div><div class="line">â”‚   â”œâ”€â”€ Bar.vue</div><div class="line">â”‚   â””â”€â”€ Baz.vue</div><div class="line">â”œâ”€â”€ App.vue</div><div class="line">â”œâ”€â”€ main.js # universal entry æˆ‘åœ¨å®è·µæ—¶æ¢äº†ä¸ªåå­—</div><div class="line">â”œâ”€â”€ entry-client.js # runs in browser only</div><div class="line">â””â”€â”€ entry-server.js # runs on server only</div></pre></td></tr></table></figure>
<p>main.jsã€entry-client.jsã€entry-server.js ä»£ç ä»æ–‡æ¡£ä¸­å¤åˆ¶æ¥ã€‚<br>*.vue æ–‡ä»¶å†…å®¹è‡ªå·±è¡¥å……ã€‚</p>
<p>è¿™é‡Œéœ€è¦webpackçš„æ¦‚å¿µï¼š å…¥å£æ–‡ä»¶ã€è¾“å‡ºæ–‡ä»¶ã€æ¨¡å—ã€æ’ä»¶ã€æ‰“åŒ…ç›®æ ‡å¹³å°ã€‚  </p>
<h4 id="åˆ›å»ºwebpacké…ç½®æ–‡ä»¶"><a href="#åˆ›å»ºwebpacké…ç½®æ–‡ä»¶" class="headerlink" title="åˆ›å»ºwebpacké…ç½®æ–‡ä»¶"></a>åˆ›å»ºwebpacké…ç½®æ–‡ä»¶</h4><blockquote>
<p>å•ƒäº†webpackæ–‡æ¡£å <a href="/2017/06/18/learn-webpack/#åŸºæœ¬é…ç½®æ–‡ä»¶">[è·³è½¬â€¦]</a>  </p>
</blockquote>
<p><strong>deal with æ–°å‡ºç°çš„ import</strong></p>
<p>åœ¨åŸºæœ¬çš„é…ç½®æ–‡ä»¶ä¸Šå¢åŠ <code>babel-loader</code>é…ç½®å³å¯å°†importè½¬è¯‘ä¸ºnodeå’Œæµè§ˆå™¨å¯ä»¥æ”¯æŒå¼•å…¥æ–¹å¼äº†ã€‚<br>è¿™é‡Œéœ€è¦å°† <code>import</code> è½¬è¯‘ä¸º <code>commonjs</code>æ–¹å¼ï¼Œè®¾ç½®babel-loaderçš„queryä¸º<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">... <span class="comment">// å‡è£…å…¶ä»–ä»£ç </span></div><div class="line"><span class="built_in">module</span>: &#123;</div><div class="line">  <span class="attr">rules</span>:[</div><div class="line">    &#123;</div><div class="line">      <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">      <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">      <span class="attr">query</span>: [</div><div class="line">        <span class="string">"presets"</span>: [</div><div class="line">          <span class="string">"env"</span>, &#123; <span class="string">"modules"</span>: <span class="string">"commonjs"</span> &#125;</div><div class="line">        ]</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125; </div><div class="line">... <span class="comment">// å‡è£…å…¶ä»–ä»£ç </span></div></pre></td></tr></table></figure></p>
<p>modules é»˜è®¤ä¸ºcommonjsï¼Œå¯ä»¥çœç•¥ã€‚å…¶ä»–å¯é€‰umd,amdç­‰ã€‚  </p>
<blockquote>
<p>// TODO å¦‚æœå¯èƒ½ï¼Œä¼šå†™ä¸€ç¯‡åˆè¯•requirejsï¼Œcommonjs.</p>
</blockquote>
<p><strong>deal with vueå•æ–‡ä»¶ç»„ä»¶</strong>  </p>
<p><code>*.vue</code>å•æ–‡ä»¶ç»„ä»¶é€šè¿‡importå¼•å…¥ï¼Œä¸ºå…¶æ·»åŠ <code>vue-loader</code>,å³å¯æ­£ç¡®å¼•å…¥ã€‚</p>
<p><strong>module.target</strong>  </p>
<p>webpack moduleé»˜è®¤çš„targetæ˜¯ webï¼Œä¸ºæœåŠ¡ç«¯ä»£ç è¿›è¡Œæ‰“åŒ…æ—¶ï¼Œéœ€è¦è®¾ç½®targetä¸º node æˆ– aysnc-nodeã€‚  </p>
<h2 id="3-ä½¿ç”¨-VueRouter"><a href="#3-ä½¿ç”¨-VueRouter" class="headerlink" title="3. ä½¿ç”¨ VueRouter"></a>3. ä½¿ç”¨ VueRouter</h2><blockquote>
<p>æˆ‘å·²æœ‰çš„vueä½¿ç”¨ç»éªŒä¸­ï¼Œåœ¨routerä¸­ï¼Œä½¿ç”¨ensureå³å¯è½»æ¾å®ç°æ‡’åŠ è½½ã€‚  </p>
</blockquote>
<p>åŠ¨æ€å¼•å…¥æ¨¡å—ï¼Œå¯ä»¥å®Œæˆæ‡’åŠ è½½æ–‡ä»¶çš„æ‰“åŒ…<br><strong>æ”¹å†™router.js</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// import About from './About.vue'</span></div><div class="line"><span class="keyword">const</span> About = <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./About.vue'</span>)</div></pre></td></tr></table></figure></p>
<p>ä½¿ç”¨vscodeä¸­js formatteræ’ä»¶ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ä»£ç æ—¶ï¼Œä¼šå°†importçš„æ ¼å¼å¼ºè¡Œæ¢è¡Œã€‚å¯ä»¥åœç”¨è‡ªåŠ¨æ ¼å¼åŒ–ã€‚  </p>
<p><strong>å¯ç”¨åŠ¨æ€åŠ è½½</strong><br>webpacké…ç½®rulesä¸­ï¼Œä¸ºbabel-loaderå¯ç”¨åŠ¨æ€å¼•å…¥æ’ä»¶<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">&#123;</div><div class="line">  <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">  <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">  <span class="attr">query</span>: &#123;</div><div class="line">    <span class="attr">presets</span>: [</div><div class="line">      [<span class="string">'env'</span>, &#123; <span class="attr">modules</span>: <span class="literal">false</span> &#125;]</div><div class="line">    ],</div><div class="line">    <span class="attr">plugins</span>: [</div><div class="line">      <span class="string">"syntax-dynamic-import"</span></div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">...</div></pre></td></tr></table></figure></p>
<p>distç›®å½•ä¸‹æ‰“åŒ…ç»“æœå¦‚ä¸‹ï¼š  </p>
<table>
<thead>
<tr>
<th>client.conf</th>
<th>-</th>
<th>server.conf</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.js</td>
<td>-</td>
<td>0.js</td>
</tr>
<tr>
<td>client.bundle.js</td>
<td>-</td>
<td>server.bundle.js</td>
</tr>
</tbody>
</table>
<p>clientå’Œserveré…ç½®æ–‡ä»¶éƒ½ä¼šç”Ÿæˆ0.js,1.jsâ€¦.<br>åœ¨æœªä½¿ç”¨manifestæƒ…å†µä¸‹ï¼Œä¸¤ä¸ªé…ç½®æ–‡ä»¶ç”Ÿæˆå†…å®¹ä¸ä¸€æ ·ï¼ˆserveré…ç½®æ–‡ä»¶ä¸­ module.targetä¸ºâ€™nodeâ€˜ï¼‰ã€‚<br>å¦‚æœåŒæ—¶ä½¿ç”¨ï¼Œéœ€è¦è°ƒæ•´è¾“å‡ºä½ç½®ï¼Œé¿å…ä»£ç è¦†ç›–ã€‚</p>
<h2 id="4-ç²—æš´çš„èåˆå‰åç«¯"><a href="#4-ç²—æš´çš„èåˆå‰åç«¯" class="headerlink" title="4. ç²—æš´çš„èåˆå‰åç«¯"></a>4. ç²—æš´çš„èåˆå‰åç«¯</h2><p>æˆ‘å¯¹éœ€æ±‚æœåŠ¡ç«¯æ¸²æŸ“çš„ç†è§£æ˜¯ï¼Œä½¿ç”¨çˆ¬è™«è·å–æŒ‡å®šurlæ—¶ï¼Œå¾—åˆ°çš„æ˜¯è¯¥urlæ¸²æŸ“å¥½çš„htmlå†…å®¹ã€‚<br>åœ¨æµè§ˆå™¨ä¸Šç¬¬ä¸€æ¬¡æ‰“å¼€æ­¤é¡µé¢æ—¶ï¼Œè¯·æ±‚åˆ°çš„htmlå†…å®¹æ˜¯å·²æ¸²æŸ“å¥½çš„ã€‚<br>åœ¨æµè§ˆå™¨ä¸Šè¿›è¡Œåç»­çš„äº¤äº’æ—¶ï¼Œç”¨çš„æ˜¯vueæ¡†æ¶çš„äº¤äº’é€»è¾‘ï¼Œè€Œä¸é‡æ–°å‘èµ·urlè¯·æ±‚ã€‚  </p>
<p><strong>å®¢æˆ·ç«¯ä½¿ç”¨åœºæ™¯</strong>ï¼š<br>å®¢æˆ·ç«¯buildä¹‹åï¼Œä½¿ç”¨æ–¹å¼æ˜¯åœ¨ä¸€ä¸ªbodyåªåŒ…å«<code>div#app</code>å…ƒç´ çš„index.htmlåº•éƒ¨æ³¨å…¥<code>script:src</code>å¼•å…¥buildå¥½çš„client.bundle.jsã€‚<br>ç„¶åä½¿ç”¨http serveræä¾›å¯¹è¿™ä¸ªindex.htmlçš„è®¿é—®ã€‚</p>
<p><strong>æœåŠ¡ç«¯ä½¿ç”¨åœºæ™¯</strong>ï¼š<br>åœ¨server.jsä¸­ é…ç½®expressï¼Œå¹¶require æ‰“åŒ…å¥½çš„entry-server.jsï¼Œå¡«å……é€»è¾‘ã€‚<br>ç„¶åè¿è¡Œ<code>node server.js</code>, å°±èƒ½åƒä½¿ç”¨nginx æ‰˜ç®¡é™æ€htmlæ–‡ä»¶å¤¹é‚£æ ·æŒ‰ç…§urlè®¿é—®æŒ‡å®šhtmlé¡µé¢ã€‚</p>
<p>ç°åœ¨ï¼Œåœ¨App.vueæ–‡ä»¶ä¸­æ ¹å…ƒç´ ä¸Šæ·»åŠ  <code>id=&#39;app&#39;</code>, æ¸²æŸ“çš„åˆ°çš„htmlä¸­åŒ…å«æ­¤ <code>id=&#39;app&#39;</code>. å¯¹æ­¤#appæŒ‚è½½Vueå³å¸¸è§„çš„Vueä½¿ç”¨æ–¹æ³•ã€‚<br>åœ¨2.3ç‰ˆæœ¬ä¸­å¯¹æœåŠ¡ç«¯æ¸²æŸ“è¿›è¡Œäº†æ”¯æŒï¼Œä¼šè‡ªåŠ¨è¾¨è¯†æœåŠ¡ç«¯æ¸²æŸ“å¥½çš„domã€‚  </p>
<p>ä½¿ç”¨æœåŠ¡ç«¯ç”Ÿæˆçš„å†…å®¹ï¼Œæ›¿æ¢å®¢æˆ·ç«¯ä½¿ç”¨åœºæ™¯ä¸­index.html å°±æ˜¯ç®€æ˜“çš„èåˆå‰åç«¯ã€‚<br>å³ï¼Œåœ¨æœåŠ¡ç«¯æ‰€ä½¿ç”¨çš„index.template.htmlé¡µé¢ä¸­ï¼Œæ·»åŠ  <code>script:src</code> å¼•å…¥å®¢æˆ·ç«¯buildçš„client.bundle.jsã€‚</p>
<p><strong>èåˆç»†èŠ‚</strong>ï¼š  </p>
<ol>
<li>åŒºåˆ†æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯æ‰“åŒ…ä»£ç <br>ä¸º server.conf, client.conf  è®¾ç½®ä¸åŒçš„output.path  </li>
<li>ä¿®æ”¹index.template.html<br>æ·»åŠ  <code>&lt;script src=&quot;./dist/bundle.js&quot;&gt;&lt;/script&gt;</code>  </li>
<li>server.jsä¸­ä¸ºexpressæ·»åŠ ä¸­é—´ä»¶å¤„ç†é€»è¾‘<br>è¯·æ±‚0.jsæ—¶ï¼Œä¼šç›´æ¥è¯·æ±‚æ ¹ç›®å½•ï¼Œè¿™é‡Œredirectä¸€ä¸‹ï¼Œè®©å®ƒå–åˆ°æ­£ç¡®çš„0.js  </li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req,res,next</span>)</span>&#123;</div><div class="line">  <span class="comment">// ä½¿ç”¨bunldeæ‡’åŠ è½½0.jsæ—¶ï¼Œå¼•ç”¨è·¯å¾„æ˜¯ä¸æ­£ç¡®çš„ï¼Œæˆ‘ä¸çŸ¥é“æ€ä¹ˆé…ç½®ï¼Œè¿™å„¿å¼ºè¡Œæ”¹ä¸€ä¸‹</span></div><div class="line">  <span class="keyword">if</span>(<span class="regexp">/\.js$/</span>.test(req.url))&#123;</div><div class="line">    res.redirect(<span class="string">'/dist'</span> + req.url)</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    next()</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>ä»£ç ç¤ºä¾‹ï¼š <a href="https://github.com/songlairui/vue-playground/tree/master/demo/chapter5" target="_blank" rel="external">songlairui/vue-playground/demo/chapter5</a>  </p>
<h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p>æŒ‰ç…§ä¸ªäººç†è§£ï¼ŒæˆåŠŸä½¿ç”¨äº†ä¸‹æœåŠ¡ç«¯æ¸²æŸ“çš„ç»“æœã€‚<br>è¿‡ç¨‹è™½ç„¶å¾ˆç²—ç³™ï¼Œä¹Ÿæ˜¯ä½¿å‡ºäº†æµ‘èº«è§£æ•°ã€‚  </p>
<p>ç¬¬äºŒç¯‡å®è·µï¼š<a href="/2017/06/22/vue-ssr-step-2/" title="Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·äºŒï¼šå‰åç«¯æ··åˆä»ç²—æš´åˆ°æ­£å¸¸">Vue SSR å®˜æ–¹æ–‡æ¡£å®è·µÂ·äºŒï¼šå‰åç«¯æ··åˆä»ç²—æš´åˆ°æ­£å¸¸</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;Vue 2.3 å‘å¸ƒå¾ˆä¹…äº†ï¼Œè·ç¦»ç¬¬ä¸€æ¬¡æ‰“å¼€&lt;a href=&quot;http://ssr.vuejs.org/en/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ssr.vuejs&lt;/a&gt;ä¹Ÿå¾ˆä¹…äº†ã€‚&lt;br&gt;ç°åœ¨æˆ‘ç»ˆäºæŠŠå…¶ä¸­çš„ä»£ç ç‰‡æ®µè¿è¡Œ
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Webpack å­¦ä¹ è®°å½•</title>
    <link href="http://songlairui.github.io/2017/06/18/learn-webpack/"/>
    <id>http://songlairui.github.io/2017/06/18/learn-webpack/</id>
    <published>2017-06-18T05:58:32.000Z</published>
    <updated>2017-06-21T06:15:48.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p> æˆ‘æƒ³è¦ä»é›¶å¼€å§‹æ„å»ºè‡ªå·±çš„åº”ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨ssr-vueã€‚è€Œå®˜æ–¹vue-cliæ²¡æœ‰ç±»ä¼¼åŸæœ‰templateçš„ssrç‰ˆã€‚<br> çœ‹æ¥ï¼Œæˆ‘éœ€è¦å­¦ä¼šwebpackäº†  </p>
</blockquote>
<h4 id="å·²æœ‰çš„å­¦ä¹ ç»å†"><a href="#å·²æœ‰çš„å­¦ä¹ ç»å†" class="headerlink" title="å·²æœ‰çš„å­¦ä¹ ç»å†"></a>å·²æœ‰çš„å­¦ä¹ ç»å†</h4><p>vue-cliè‡ªå¸¦çš„webpacké…ç½®ï¼Œçœ‹è¿‡å¥½å‡ æ¬¡ã€‚è‡ªå·±æ·»åŠ ä¸€äº›chunkï¼Œè‡ªåŠ¨ç”Ÿæˆå¤šä¸ªé¡µé¢ï¼Œè§‰å¾—è‡ªå·±åšäº†å¾ˆå¤§ä¸€ä»¶äº‹æƒ…ï¼Œè€Œå®¢è§‚ä¸Šå¹¶ä¸å¤§ã€‚<br>webpackæ–‡æ¡£å°è¯•çœ‹äº†å¥½å‡ æ¬¡ï¼Œä»æ¥è§‰å¾—å¤ªé•¿æ²¡çœ‹å®Œã€‚  </p>
<h3 id="Current"><a href="#Current" class="headerlink" title="Current"></a>Current</h3><p>é“¾æ¥åœ°å€ï¼š  <a href="http://www.css88.com/doc/webpack2/concepts/module-resolution/" target="_blank" rel="external">http://www.css88.com/doc/webpack2/concepts/module-resolution/</a><br>æˆ‘è¿˜æ˜¯ä»å¤´å¼€å§‹çœ‹äº†å…¥å£æ–‡ä»¶ï¼Œé…ç½®æ–¹æ³•ã€‚<br>ç›®å‰çœ‹æ¥ï¼Œæ¦‚å¿µéƒ¨åˆ†ï¼Œåº”è¯¥æ˜¯ä¸€å£æ°”çœ‹å®Œçš„ã€‚ç„¶åå†åœ¨æŒ‡å—ä¸çƒ¦ï¼Œè”ç³»ä»£ç ç‰‡æ®µã€‚<br>è¿™å„¿ï¼Œæˆ‘è”æƒ³åˆ°äº†vimtutorä¸­çš„ç»ƒä¹ æ–¹å¼ã€‚</p>
<h3 id="åŸºæœ¬é…ç½®æ–‡ä»¶"><a href="#åŸºæœ¬é…ç½®æ–‡ä»¶" class="headerlink" title="åŸºæœ¬é…ç½®æ–‡ä»¶"></a>åŸºæœ¬é…ç½®æ–‡ä»¶</h3><blockquote>
<p>å•ƒäº†webpackæ–‡æ¡£åï¼Œèƒ½å¿«é€Ÿæ‰‹æ‰“webpackçš„æœ€ç®€å•é…ç½®æ–‡ä»¶ã€‚æ‰€æœ‰çš„é…ç½®éƒ½åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ ã€‚  </p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'/path/to/entry/file'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'output.js'</span>,</div><div class="line">    <span class="attr">path</span>: __dirname</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">module</span>:&#123;</div><div class="line">    <span class="attr">rules</span>:[</div><div class="line">      ...</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>å¸¸è§é€‰é¡¹</strong>  </p>
<ol>
<li>resolve<br>webpack è§£æã€‚<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">resolve: &#123;</div><div class="line">    <span class="attr">alias</span>: &#123;</div><div class="line">      <span class="string">'vue'</span>: <span class="string">'vue/dist/vue.common.js'</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">// extensions: ['.ts', '.vue', '.js']</span></div><div class="line">  &#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>é»˜è®¤é€»è¾‘ä¸å¤Ÿå‡†ç¡®æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨æ·»åŠ aliasã€‚<br>éœ€è¦ä¸ºvueä½¿ç”¨ vue.esm.jsæ—¶ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ aliasæ›´æ”¹ã€‚  </p>
<ol>
<li>devtool  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">devtool: <span class="string">'source-map'</span></div></pre></td></tr></table></figure>
</li>
</ol>
<p>ç”¨æ¥ç”Ÿæˆsource-mapæ–‡ä»¶  </p>
<ol>
<li><p>entry<br>å¯ç”±åŸºæœ¬çš„ å€¼ å˜æˆ é”®-å€¼ã€‚  </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">entry: &#123;</div><div class="line">  <span class="attr">main</span>: <span class="string">'./main.js'</span>,</div><div class="line">  <span class="attr">server</span>: <span class="string">'./server.js'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>output  </p>
<pre><code class="javascript">output: {
<span class="attr">filename</span>: <span class="string">'[chunk].bundle.js'</span>,
<span class="attr">path</span>: path.resolve(__dirname, <span class="string">'dist'</span>)
}
</code></pre>
<p>éœ€è¦å…ˆ <code>const path = require(&#39;path&#39;)</code>, è¿™é‡Œpathå±æ€§çš„å†™æ³•å³ä½¿ç”¨å…¼å®¹å…¨å¹³å°çš„æ–¹å¼æŒ‡å®šå½“å‰ç›®å½•ä¸‹çš„distç›®å½•ä¸ºè¾“å‡ºç›®å½•ã€‚<br><code>filename</code>å±æ€§çš„<code>[chunk]</code>èƒ½è®©entryä¸­çš„main.js è¾“å‡ºä¸º main.bundle.js ï¼Œç±»ä¼¼çš„è¿˜æœ‰<code>[name]</code>ã€<code>[chunkhash]</code>ã€<code>[hash]</code>ã€‚  </p>
</li>
<li><p>rules<br>æŒ‡å®šloaderã€‚webpack2å…¼å®¹webpack1ç­‰loaderå†™æ³•ã€‚</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt; æˆ‘æƒ³è¦ä»é›¶å¼€å§‹æ„å»ºè‡ªå·±çš„åº”ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨ssr-vueã€‚è€Œå®˜æ–¹vue-cliæ²¡æœ‰ç±»ä¼¼åŸæœ‰templateçš„ssrç‰ˆã€‚&lt;br&gt; çœ‹æ¥ï¼Œæˆ‘éœ€è¦å­¦ä¼šwebpackäº†  &lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;å·²æœ‰çš„å­¦ä¹ ç»å†&quot;&gt;&lt;a href
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>CSS-Animation-Controlling</title>
    <link href="http://songlairui.github.io/2017/06/10/CSS-Animation-Controlling/"/>
    <id>http://songlairui.github.io/2017/06/10/CSS-Animation-Controlling/</id>
    <published>2017-06-10T08:33:57.000Z</published>
    <updated>2017-06-11T15:27:38.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æˆ‘çš„Login formå­˜åœ¨ä¸€å¤šbugã€‚åœ¨CSSåŠ¨ç”»çš„æ§åˆ¶ä¸Šæ¬ ç¼ºã€‚</p>
</blockquote>
<p>ä½¿ç”¨ element.offsetWidth è§£å†³äº†æˆ‘çš„CSSåŠ¨ç”»é‡ç»˜é—®é¢˜ã€‚<br>è€Œä¸”æ•ˆæœå¾ˆç¨³å®šã€‚  </p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æˆ‘çš„Login formå­˜åœ¨ä¸€å¤šbugã€‚åœ¨CSSåŠ¨ç”»çš„æ§åˆ¶ä¸Šæ¬ ç¼ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½¿ç”¨ element.offsetWidth è§£å†³äº†æˆ‘çš„CSSåŠ¨ç”»é‡ç»˜é—®é¢˜ã€‚&lt;br&gt;è€Œä¸”æ•ˆæœå¾ˆç¨³å®šã€‚  &lt;/p&gt;

    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Hello</title>
    <link href="http://songlairui.github.io/2017/06/08/hello-world/"/>
    <id>http://songlairui.github.io/2017/06/08/hello-world/</id>
    <published>2017-06-08T05:36:25.000Z</published>
    <updated>2017-06-21T04:49:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>Pure Writing</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Pure Writing&lt;/p&gt;

    
    </summary>
    
    
  </entry>
  
</feed>
